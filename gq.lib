#!/bin/bash

function find_git_dir_nice
{
	git-rev-parse --git-dir
}

function find_git_dir
{
	d=`find_git_dir_nice`

	[ $? -ne 0 -o -z "$d" ] && exit 1

	echo "$d"
}

function get_branch
{
	git-symbolic-ref HEAD | sed -e 's,^refs/heads/,,'
}

function get_branch_verify
{
	b=`get_branch`
	if [ ! -d "$GIT_DIR/patches/$branch" ]; then
		echo "Branch $branch is not initialized, try gq-init"
		exit 1
	fi

	echo "$b"
}

